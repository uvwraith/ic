/* Minified on 1/14/2022 */
"use strict";Alkami.Dom.onDocumentReady(()=>{const e=!!window.debugMode,t=!Alkami.Globals.isAuthenticated,o=window.location.pathname.includes("/Registration"),n=window.location.pathname.includes("/Authentication"),i=e||t?"/Client/Ping":"/Client/CheckSessionAlive",l=Alkami.Helpers.isMobileUrl()?"/Mobile/Logout":"/Logout",s=Alkami.Helpers.isNativeTabletApplication(),a=Alkami.Helpers.isNativeApplication();if((t||e)&&(a||s))return;if(setInterval((function(){fetch(i,{credentials:"same-origin"}).then(e=>e.text()).then(e=>"OK"===e?Promise.resolve(e):Promise.reject(e)).catch(e=>{n||(window.location.href=l+"?idle=true")})}),6e4),e||t&&!o)return;if(s||a)return;const d=document.querySelector(".localization.sessionDialog");let r='<div><p>You have been inactive for a while. You will be logged out in <span id="session-timeout-countdown" style="font-weight:bold"></span> seconds.</p></div>',c="I'm still here!",u="Logout",w="Are you still there?";if(d){const e=d.dataset;r=e.bodyContent||r,c=e.stillHereButtonText||c,u=e.logoutButtonText||u,w=e.sessionModalTitle||w}const m=Alkami.Helpers.createDialog({id:"session-dialog",title:w,content:r,handlers:{logout:function(e){e.target.innerHTML="Please wait...",window.location.href=l},cancel:function(e){window.clearInterval(window.sessionDialogCountdown),h.resetTimer()}},buttons:[{text:u,type:"secondary",handlerName:"logout",closePrompt:!1},{text:c,handlerName:"cancel",closePrompt:!0}]}),g=document.documentElement,h=new IdleTimeout(g,{delay:1e3*window.idleLogoutMinutes*60,keepAliveEvents:["keydown","mousedown"],pollDelay:6e4});g.addEventListener("idletimeout-expire",()=>{let e=30;const t=document.getElementById("session-timeout-countdown"),o=()=>{t&&(t.innerHTML=e.toString())};o(),m.open=!0,window.sessionDialogCountdown=window.setInterval((function(){let t=h.delay+3e4,n=Date.now()-h.startTime;e=Math.ceil((t-n)/1e3),o(),e<=0&&(window.clearInterval(window.sessionDialogCountdown),window.location.href=l+"?idle=true")}),1e3)})});
//# sourceMappingURL=idle-modal-ts.min.js.map
